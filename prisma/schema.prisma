generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model cliente {
  correo        String   @id @db.VarChar(100)
  localidad     String?  @db.VarChar(100)
  calle         String?  @db.VarChar(100)
  piso          String?  @db.VarChar(10)
  numero        Int?
  codigo_postal String?  @db.VarChar(10)
  usuario       usuario  @relation(fields: [correo], references: [correo], onDelete: NoAction, onUpdate: NoAction)
  pedido        pedido[]
}

model contiene {
  id              Int
  nombre_producto String    @db.VarChar(100)
  unidades        Int?
  pedido          pedido    @relation(fields: [id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  productos       productos @relation(fields: [nombre_producto], references: [nombre_producto], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, nombre_producto])
}

model pedido {
  id           Int        @id
  fecha        DateTime?  @db.Date
  precio_total Decimal?   @db.Decimal(10, 2)
  correo       String?    @db.VarChar(100)
  contiene     contiene[]
  cliente      cliente?   @relation(fields: [correo], references: [correo], onDelete: NoAction, onUpdate: NoAction)
}

model productos {
  nombre_producto    String       @id @db.VarChar(100)
  descripcion        String?
  precio             Decimal?     @db.Decimal(10, 2)
  nombre_restaurante String?      @db.VarChar(100)
  contiene           contiene[]
  restaurante        restaurante? @relation(fields: [nombre_restaurante], references: [nombre_restaurante], onDelete: NoAction, onUpdate: NoAction)
}

model propietario {
  correo      String        @id @db.VarChar(100)
  usuario     usuario       @relation(fields: [correo], references: [correo], onDelete: NoAction, onUpdate: NoAction)
  restaurante restaurante[]
}

model restaurante {
  nombre_restaurante String       @id @db.VarChar(100)
  numtelefono        String?      @db.VarChar(15)
  categoria          String?      @db.VarChar(50)
  correo             String?      @db.VarChar(100)
  localidad          String?      @db.VarChar(100)
  productos          productos[]
  propietario        propietario? @relation(fields: [correo], references: [correo], onDelete: NoAction, onUpdate: NoAction)
}

model usuario {
  correo         String       @id @db.VarChar(100)
  nombre_usuario String       @db.VarChar(100)
  password       String       @db.VarChar(100)
  tipo           String       @db.VarChar(11)
  cliente        cliente?
  propietario    propietario?
}

enum tipo_usuario {
  Cliente
  Propietario
}
